<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Puppet Docs</title>
    <link rel="stylesheet" type="text/css" href="../../files/stylesheets/style.css" media="all"/>
    <link rel="stylesheet" type="text/css" href="../../files/stylesheets/syntax.css" media="all"/>
  <script type="text/javascript" src="../../files/javascripts/guides.js"></script>
  <!-- <script type="text/javascript" src="../../files/javascripts/code_highlighter.js"></script><script type="text/javascript" src="../../files/javascripts/highlighters.js"></script> --></head>
  <body class="guide">
    <div id="topNav">
      <div class="wrapper">
        <strong>More at <a href="http://reductivelabs.com/">reductivelabs.com:</a> </strong>
        <a href="http://projects.reductivelabs.com/">Issue Tracker</a>
      </div>
    </div>
    <div id="header">
      <div class="wrapper clearfix">
        <h1><a href="../../index.html" title="Return to home page">docs.reductivelabs.com</a></h1>
        <p class="hide"><a href="#mainCol">Skip navigation</a>.</p>
        <ul class="nav">
          <li><a href="../../index.html">Home</a></li>
          <li class="index"><a href="index.html" onclick="guideMenu(); return false;" id="guidesMenu">Docs Index</a>
          <div id="index-dialog" class="clearfix" style="display: none;">
            <hr />
            <dl class="L">
              <dt>Guides</dt>
              <dd><a href="../../introduction.html">An Introduction to Puppet</a></dd>
              <dd><a href="../../installation.html">Installing Puppet</a></dd>
              <dd><a href="../../language_tutorial.html">Puppet Language Tutorial</a></dd>
            </dl>
            <dl class="R">
              <dt>References</dt>
              <dd><a href="../../types/">Resource Types (Categorized)</a></dd>
              <dd><a href="../../types/alphabetical_index.html">Resource Types (Alphabetical)</a></dd>
            </dl>
          </div>
          </li>
          <li><a href="contribute.html">Contribute</a></li>
        </ul>
      </div>
    </div>
    <hr class="hide" />

    <div id="feature">
      <div class="wrapper">
        <h1 id='file'>file</h1>

<p>Manages local files.</p>

<ul>
<li>Sets ownership and permissions.</li>

<li>Supports creation of both files and directories.</li>

<li>Retrieves entire files from remote servers.</li>
</ul>
        
              <div id="subCol">
        <h3 class="chapter"><img src="../../images/chapters_icon.gif" alt="" />Contents</h3>
        <ol class="chapters">
<li><a href="#background">Background</a></li>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#platforms">Platforms</a></li>
<li><a href="#version_compatibility">Version Compatibility</a></li>
<li><a href="#examples">Examples</a></li>
<li>
<a href="#parameters">Parameters</a><ul style="list-style: none;">
<li><a href="#id103"><code>backup</code></a></li>
<li><a href="#id104"><code>checksum</code></a></li>
<li><a href="#id105"><code>content</code></a></li>
<li><a href="#id106"><code>ensure</code></a></li>
<li><a href="#id107"><code>force</code></a></li>
<li><a href="#id108"><code>group</code></a></li>
<li><a href="#id109"><code>ignore</code></a></li>
<li><a href="#id110"><code>links</code></a></li>
<li><a href="#id111"><code>mode</code></a></li>
<li><a href="#id112"><code>owner</code></a></li>
<li><a href="#id113"><code>path</code></a></li>
<li><a href="#id114"><code>purge</code></a></li>
<li><a href="#id115"><code>recurse</code></a></li>
<li><a href="#id116"><code>recurselimit</code></a></li>
<li><a href="#id117"><code>replace</code></a></li>
<li><a href="#id118"><code>selrange</code></a></li>
<li><a href="#id119"><code>selrole</code></a></li>
<li><a href="#id120"><code>seltype</code></a></li>
<li><a href="#id121"><code>seluser</code></a></li>
<li><a href="#id122"><code>source</code></a></li>
<li><a href="#id123"><code>sourceselect</code></a></li>
<li><a href="#id124"><code>target</code></a></li>
<li><a href="#id125"><code>type</code></a></li>
</ul>
</li></ol></div>
      </div>
    </div>
    
    <div id="container">
      <div class="wrapper">
        <div id="mainCol">
          <h2 id='background'>Background</h2>

<p>As Puppet matures, it expected that the <code>file</code> resource will be used less and less to manage content, and instead native resources will be used to do so.</p>
<div class='note'><p>If you find that you are often copying files in from a central location, rather than using native resources, please contact Reductive Labs and we can hopefully work with you to develop a native resource to support what you are doing.</p></div>
<h2 id='requirements'>Requirements</h2>

<p>No additional requirmements.</p>

<h2 id='platforms'>Platforms</h2>

<p>All platforms.</p>

<h2 id='version_compatibility'>Version Compatibility</h2>
<div class='warning'><p>This section has not been completed.</p></div>
<h2 id='examples'>Examples</h2>

<p>Here is a simple example:</p>

<pre><code>file { &quot;/var/www/my/file&quot;:
    source =&gt; &quot;/path/in/nfs/or/something&quot;,
    mode   =&gt; 666
}</code></pre>

<p>There are also a number of additional, more complete examples below.</p>

<h2 id='parameters'>Parameters</h2>

<h3 id='id126'><code>backup</code></h3>

<p>Whether files should be backed up before being replaced. The preferred method of backing files up is via a <code>filebucket</code>, which stores files by their MD5 sums and allows easy retrieval without littering directories with backups. You can specify a local filebucket or a network-accessible server-based filebucket by setting <code>backup =&gt; bucket-name</code>. Alternatively, if you specify any value that begins with a <code>.</code> (e.g., <code>.puppet-bak</code>), then Puppet will use copy the file in the same directory with that value as the extension of the backup. Setting <code>backup =&gt; false</code> disables all backups of the file in question.</p>

<p>Puppet automatically creates a local filebucket named <code>puppet</code> and defaults to backing up there. To use a server-based filebucket, you must specify one in your configuration:</p>

<pre><code>filebucket { main:
    server =&gt; puppet
}</code></pre>

<p>The <code>puppetmasterd</code> daemon creates a filebucket by default, so you can usually back up to your main server with this configuration. Once you&#8217;ve described the bucket in your configuration, you can use it in any <code>file::</code></p>

<pre><code>file { &quot;/my/file&quot;:
    source =&gt; &quot;/path/in/nfs/or/something&quot;,
    backup =&gt; main
}</code></pre>

<p>This will back the file up to the central server.</p>

<p>At this point, the benefits of using a filebucket are that you do not have backup files lying around on each of your machines, a given version of a file is only backed up once, and you can restore any given file manually, no matter how old. Eventually, transactional support will be able to automatically restore filebucketed files.</p>

<h3 id='id127'><code>checksum</code></h3>

<p>How to check whether a file has changed. This state is used internally for file copying, but it can also be used to monitor files somewhat like Tripwire without managing the file contents in any way. You can specify that a file&#8217;s checksum should be monitored and then subscribe to the file from another object and receive events to signify checksum changes, for instance.</p>

<p>There are a number of checksum types available including MD5 hashing (and an md5lite variation that only hashes the first 500 characters of the file.</p>

<p>The default checksum parameter, if checksums are enabled, is md5. Valid values are <code>md5</code>, <code>md5lite</code>, <code>timestamp</code>, <code>mtime</code>, <code>time</code>. Values can match <code>/^\{md5|md5lite|timestamp|mtime|time\}/</code>.</p>

<h3 id='id128'><code>content</code></h3>

<p>Specify the contents of a file as a string. Newlines, tabs, and spaces can be specified using the escaped syntax (e.g., n for a newline). The primary purpose of this parameter is to provide a kind of limited templating:</p>

<pre><code>define resolve(nameserver1, nameserver2, domain, search) {
    $str = &quot;search $search
            domain $domain
            nameserver $nameserver1
            nameserver $nameserver2&quot;
    file { &quot;/etc/resolv.conf&quot;:
        content =&gt; $str
    }
}</code></pre>

<p>This attribute is especially useful when used with templating.</p>

<h3 id='id129'><code>ensure</code></h3>

<p>Whether to create files that don&#8217;t currently exist. Possible values are <em>absent</em>, <em>present</em>, <em>file</em>, and <em>directory</em>. Specifying <code>present</code> will match any form of file existence, and if the file is missing will create an empty file. Specifying <code>absent</code> will delete the file (and directory if recurse =&gt; true).</p>

<p>Anything other than those values will be considered to be a symlink. For instance, the following text creates a link:</p>

<pre><code># Useful on solaris
file { &quot;/etc/inetd.conf&quot;:
    ensure =&gt; &quot;/etc/inet/inetd.conf&quot;
}</code></pre>

<p>You can make relative links:</p>

<pre><code># Useful on solaris
file { &quot;/etc/inetd.conf&quot;:
    ensure =&gt; &quot;inet/inetd.conf&quot;
}</code></pre>

<p>If you need to make a relative link to a file named the same as one of the valid values, you must prefix it with <code>./</code> or something similar.</p>

<p>You can also make recursive symlinks, which will create a directory structure that maps to the target directory, with directories corresponding to each directory and links corresponding to each file. Valid values are <code>absent</code> (also called <code>false</code>), <code>file</code>, <code>present</code>, <code>directory</code>, <code>link</code>. Values can match <code>/./</code>.</p>

<h3 id='id130'><code>force</code></h3>

<p>Force the file operation. Currently only used when replacing directories with links. Valid values are <code>true</code>, <code>false</code>.</p>

<h3 id='id131'><code>group</code></h3>

<p>Which group should own the file. Argument can be either group name or group ID.</p>

<h3 id='id132'><code>ignore</code></h3>

<p>A parameter which omits action on files matching specified patterns during recursion. Uses Ruby&#8217;s builtin globbing engine, so shell metacharacters are fully supported, e.g. <code>[a-z]*</code>. Matches that would descend into the directory structure are ignored, e.g., <code>*/*</code>.</p>

<h3 id='id133'><code>links</code></h3>

<p>How to handle links during file actions. During file copying, <code>follow</code> will copy the target file instead of the link, <code>manage</code> will copy the link itself, and <code>ignore</code> will just pass it by. When not copying, <code>manage</code> and <code>ignore</code> behave equivalently (because you cannot really ignore links entirely during local recursion), and <code>follow</code> will manage the file to which the link points. Valid values are <code>follow</code>, <code>manage</code>.</p>

<h3 id='id134'><code>mode</code></h3>

<p>Mode the file should be. Currently relatively limited: you must specify the exact mode the file should be.</p>

<h3 id='id135'><code>owner</code></h3>

<p>To whom the file should belong. Argument can be user name or user ID.</p>

<h3 id='id136'><code>path</code></h3>

<p>The path to the file to manage. Must be fully qualified.</p>
<div class='info'><p>This is the <code>namevar</code> for this resource type.</p></div>
<h3 id='id137'><code>purge</code></h3>

<p>Whether unmanaged files should be purged. If you have a filebucket configured the purged files will be uploaded, but if you do not, this will destroy data. Only use this option for generated files unless you really know what you are doing. This option only makes sense when recursively managing directories.</p>

<p>Note that when using <code>purge</code> with <code>source</code>, Puppet will purge any files that are not on the remote system. Valid values are <code>true</code>, <code>false</code>.</p>

<h3 id='id138'><code>recurse</code></h3>

<p>Whether and how deeply to do recursive management. Valid values are <code>true</code>, <code>false</code>, <code>inf</code>, <code>remote</code>. Values can match <code>/^[0-9]+$/</code>.</p>

<h3 id='id139'><code>recurselimit</code></h3>

<p>How deeply to do recursive management. Values can match <code>/^[0-9]+$/</code>.</p>

<h3 id='id140'><code>replace</code></h3>

<p>Whether or not to replace a file that is sourced but exists. This is useful for using file sources purely for initialization. Valid values are <code>true</code> (also called <code>yes</code>), <code>false</code> (also called <code>no</code>).</p>

<h3 id='id141'><code>selrange</code></h3>

<p>What the SELinux range component of the context of the file should be. Any valid SELinux range component is accepted. For example <code>s0</code> or <code>SystemHigh</code>. If not specified it defaults to the value returned by matchpathcon for the file, if any exists. Only valid on systems with SELinux support enabled and that have support for MCS (Multi-Category Security).</p>

<h3 id='id142'><code>selrole</code></h3>

<p>What the SELinux role component of the context of the file should be. Any valid SELinux role component is accepted. For example <code>role_r</code>. If not specified it defaults to the value returned by matchpathcon for the file, if any exists. Only valid on systems with SELinux support enabled.</p>

<h3 id='id143'><code>seltype</code></h3>

<p>What the SELinux type component of the context of the file should be. Any valid SELinux type component is accepted. For example <code>tmp_t</code>. If not specified it defaults to the value returned by matchpathcon for the file, if any exists. Only valid on systems with SELinux support enabled.</p>

<h3 id='id144'><code>seluser</code></h3>

<p>What the SELinux user component of the context of the file should be. Any valid SELinux user component is accepted. For example <code>user_u</code>. If not specified it defaults to the value returned by matchpathcon for the file, if any exists. Only valid on systems with SELinux support enabled.</p>

<h3 id='id145'><code>source</code></h3>

<p>Copy a file over the current file. Uses <code>checksum</code> to determine when a file should be copied. Valid values are either fully qualified paths to files, or URIs. Currently supported URI types are <em>puppet</em> and <em>file</em>.</p>

<p>This is one of the primary mechanisms for getting content into applications that Puppet does not directly support and is very useful for those configuration files that don&#8217;t change much across sytems. For instance:</p>

<pre><code>class sendmail {
    file { &quot;/etc/mail/sendmail.cf&quot;:
        source =&gt; &quot;puppet://server/module/sendmail.cf&quot;
    }
}</code></pre>

<p>You can also leave out the server name, in which case <code>puppetd</code> will fill in the name of its configuration server and <code>puppet</code> will use the local filesystem. This makes it easy to use the same configuration in both local and centralized forms.</p>

<p>Currently, only the <code>puppet</code> scheme is supported for source URL&#8217;s. Puppet will connect to the file server running on <code>server</code> to retrieve the contents of the file. If the <code>server</code> part is empty, the behavior of the command-line interpreter (<code>puppet</code>) and the client demon (<code>puppetd</code>) differs slightly: <code>puppet</code> will look such a file up on the module path on the local host, whereas <code>puppetd</code> will connect to the puppet server that it received the manifest from.</p>

<p>See the fileserver configuration documentation for information on how to configure and use file services within Puppet.</p>

<p>If you specify multiple file sources for a file, then the first source that exists will be used. This allows you to specify what amount to search paths for files:</p>

<pre><code>file { &quot;/path/to/my/file&quot;:
    source =&gt; [
        &quot;/nfs/files/file.$host&quot;,
        &quot;/nfs/files/file.$operatingsystem&quot;,
        &quot;/nfs/files/file&quot;
    ]
}</code></pre>

<p>This will use the first found file as the source.</p>
<div class='note'><p>You cannot currently copy links using this mechanism; set <code>links</code> to <code>follow</code> if any remote sources are links.</p></div>
<h3 id='id146'><code>sourceselect</code></h3>

<p>Whether to copy all valid sources, or just the first one. This parameter is only used in recursive copies; by default, the first valid source is the only one used as a recursive source, but if this parameter is set to <code>all</code>, then all valid sources will have all of their contents copied to the local host, and for sources that have the same file, the source earlier in the list will be used. Valid values are <code>first</code>, <code>all</code>.</p>

<h3 id='id147'><code>target</code></h3>

<p>The target for creating a link. Currently, symlinks are the only type supported. Valid values are <code>notlink</code>. Values can match <code>/./</code>.</p>

<h3 id='id148'><code>type</code></h3>

<p>A read-only state to check the file type.</p>
        </div>
      </div>
    </div>
    
    <hr class="hide" />
    
    <div id="footer">
      <div class="wrapper">
        <p>&copy; 2009 Reductive Labs.</p>
        <p>This work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-Share Alike 3.0</a> License.</p>
        <p>The documentation format are based on the &#8220;Rails Guides&#8221; project by the Ruby on Rails community.</p> 
      </div>
    </div>

  </body>
</html>